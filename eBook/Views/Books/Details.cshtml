@model eBook.Models.Book
@using eBook.App_Start

@{
    ViewBag.Title = @Html.DisplayFor(model => model.Title);
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div>
    <h4>@Html.DisplayFor(model => model.Title)'s Details</h4>
    <hr />
    <dl class="dl-horizontal">

        <dd>
            @Html.DisplayFor(model => model.Title)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Author)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Author)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.Price)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.Price)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.genre)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.genre)
        </dd>

        <dt>
            @Html.DisplayNameFor(model => model.publisher)
        </dt>

        <dd>
            @Html.DisplayFor(model => model.publisher)
        </dd>

        @if (!string.IsNullOrWhiteSpace(Model.Image))
        {
            <dt>
                @Html.DisplayNameFor(model => model.Image)
            </dt>

            <dd>
                <img src="@Html.DisplayFor(model => model.Image)" class="book-pic" />

            </dd>
        }
        @if (string.IsNullOrWhiteSpace(Model.Image))
        {
            <dt>
                @Html.DisplayNameFor(model => model.Image)
            </dt>

            <dd>
                <img src="~/Content/images/book.jpg" alt="No Image" class="book-pic" />

            </dd>
        }

        @if (!string.IsNullOrWhiteSpace(Model.Video))
        {
            <dt>
                @Html.DisplayNameFor(model => model.Video)
            </dt>


            <dd>
                @Html.DisplayFor(model => model.Video)
            </dd>
        }

        @if (!string.IsNullOrWhiteSpace(Model.TwitterWidgets))
        {
            <dt>
                @Html.DisplayNameFor(model => model.TwitterWidgets)
            </dt>
            <dd>
                @Html.Raw(@Model.TwitterWidgets.ToString())
            </dd>
        }
    </dl>
</div>
<p>
    @if (User.IsInRole(IdentityConfigGlobals.MANAGER_ROLE))
    {
        @Html.ActionLink("Edit", "Edit", new { id = Model.ProductId })
    }
    <span> | </span>
    @if (User.IsInRole(IdentityConfigGlobals.MANAGER_ROLE))
    {
        @Html.ActionLink("Delete", "Delete", new { id = Model.ProductId })
    }

</p>

<table id="tblStudent" class="table table-bordered table-striped table-responsive table-hover">
    <tbody></tbody>
</table>

<div id="comments">

</div>

@Scripts.Render("~/bundles/modernizr")
@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/bundles/bootstrap")
@Scripts.Render("~/bundles/d3")

<script type="text/javascript">
    $(function () {
        LoadData();
    });

    function LoadData() {
        $.ajax({
            type: 'GET',
            url: 'https://localhost:44357/Comments',
            dataType: 'html',
            data: { id: '' },
            success: function (data) {
                var items = '';
                $('#comments').append(data);
/*                $.each(data, function (i, item) {
                    var rows = "<tr>"
                        + "<td>" + item.Author + "</td>"
                        + "<td>" + item.body + "</td>"
                        + "</tr>";
                    $('#tblStudent tbody').append(rows);
                });*/
            },
            error: function (ex) {
                var r = jQuery.parseJSON(response.responseText);
                alert("Message: " + r.Message);
                alert("StackTrace: " + r.StackTrace);
                alert("ExceptionType: " + r.ExceptionType);
            }
        });
        return false;
    }
</script>  